"use strict";(self.webpackChunkfury=self.webpackChunkfury||[]).push([[337],{74061:(T,b,l)=>{l.d(b,{m:()=>d});var r=l(17705),g=l(60177),i=l(99213),m=l(52920),v=l(18498);function p(y,t){if(1&y&&(r.j41(0,"div",7)(1,"mat-icon",5),r.EFF(2,"chevron_right"),r.k0s(),r.j41(3,"div",6),r.EFF(4),r.k0s()()),2&y){const E=t.$implicit;r.R7$(4),r.JRh(E)}}const R=function(){return["/"]};let d=(()=>{class y{constructor(){this.crumbs=[]}ngOnInit(){}static{this.\u0275fac=function(f){return new(f||y)}}static{this.\u0275cmp=r.VBU({type:y,selectors:[["fury-breadcrumbs"]],inputs:{current:"current",crumbs:"crumbs"},decls:11,vars:5,consts:[[1,"title"],["fxLayout","row","fxLayoutAlign","start center",1,"crumbs"],[1,"crumb","home",3,"routerLink"],["class","crumb","fxLayout","row","fxLayoutAlign","start center",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center",1,"crumb","current"],[1,"chevron"],[1,"link"],["fxLayout","row","fxLayoutAlign","start center",1,"crumb"]],template:function(f,h){1&f&&(r.j41(0,"div",0),r.EFF(1),r.k0s(),r.j41(2,"div",1)(3,"a",2),r.EFF(4,"Home"),r.k0s(),r.DNE(5,p,5,1,"div",3),r.j41(6,"div",4)(7,"mat-icon",5),r.EFF(8,"chevron_right"),r.k0s(),r.j41(9,"div",6),r.EFF(10),r.k0s()()()),2&f&&(r.R7$(1),r.JRh(h.current),r.R7$(2),r.Y8G("routerLink",r.lJ4(4,R)),r.R7$(2),r.Y8G("ngForOf",h.crumbs),r.R7$(5),r.JRh(h.current))},dependencies:[g.Sq,i.An,m.DJ,m.sA,v.Wk],styles:["[_nghost-%COMP%]{display:block}.title[_ngcontent-%COMP%]{font:var(--font-title);font-weight:400}.crumb[_ngcontent-%COMP%], .link[_ngcontent-%COMP%]{text-decoration:none;transition:color .4s cubic-bezier(.25,.8,.25,1);font:var(--font-body-1)}.link[_ngcontent-%COMP%]{cursor:pointer}.chevron[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px;margin-left:6px;margin-right:6px;-webkit-user-select:none;user-select:none;cursor:default}"]})}}return y})()},75063:(T,b,l)=>{l.d(b,{s:()=>w});var r=l(17705),g=l(33726),i=l(23294),m=l(70152),v=l(60177),p=l(99213),R=l(88834),d=l(59115),y=l(82765),t=l(52920),E=l(89417);const f=["filter"];function h(x,O){if(1&x&&(r.j41(0,"div",5)(1,"div",6),r.EFF(2),r.k0s(),r.j41(3,"div",7)(4,"mat-icon",8),r.EFF(5,"search"),r.k0s(),r.nrm(6,"input",9,10),r.k0s(),r.j41(8,"button",11)(9,"mat-icon"),r.EFF(10,"filter_list"),r.k0s()(),r.SdG(11,1),r.k0s()),2&x){const _=r.XpG(),C=r.sdS(3);r.R7$(2),r.JRh(_.name),r.R7$(6),r.Y8G("matMenuTriggerFor",C)}}function D(x,O){if(1&x){const _=r.RV6();r.j41(0,"div",12),r.bIt("click",function(F){const $=r.eBV(_).$implicit,I=r.XpG();return r.Njj(I.toggleColumnVisibility($,F))}),r.j41(1,"mat-checkbox",13,14),r.bIt("ngModelChange",function(F){const $=r.eBV(_).$implicit;return r.Njj($.visible=F)})("click",function(F){return F.stopPropagation()}),r.EFF(3),r.k0s()()}if(2&x){const _=O.$implicit;r.R7$(1),r.Y8G("ngModel",_.visible),r.R7$(2),r.SpI(" ",_.name," ")}}const N=["*",[["",8,"actions"]]],S=["*",".actions"];let w=(()=>{class x{constructor(_){this.cd=_,this.filterChange=new r.bkB}ngAfterViewInit(){this.hideHeader||(0,g.R)(this.filter.nativeElement,"keyup").pipe((0,i.F)(),(0,m.B)(150)).subscribe(()=>{this.filterChange.emit(this.filter.nativeElement.value)})}toggleColumnVisibility(_,C){C.stopPropagation(),C.stopImmediatePropagation(),_.visible=!_.visible,this.cd.markForCheck()}static{this.\u0275fac=function(C){return new(C||x)(r.rXU(r.gRc))}}static{this.\u0275cmp=r.VBU({type:x,selectors:[["fury-list"]],viewQuery:function(C,F){if(1&C&&r.GBs(f,5),2&C){let j;r.mGM(j=r.lsd())&&(F.filter=j.first)}},inputs:{name:"name",columns:"columns",hideHeader:"hideHeader"},outputs:{filterChange:"filterChange"},ngContentSelectors:S,decls:6,vars:2,consts:[[1,"fury-list-table"],["class","fury-list-header","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",4,"ngIf"],["yPosition","below","xPosition","before"],["columnFilter","matMenu"],["class","checkbox-item mat-menu-item",3,"click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",1,"fury-list-header"],[1,"fury-list-name"],["fxLayout","row","fxLayoutAlign","start center","fxFlex",""],[1,"fury-filter-input-icon"],["fxFlex","","placeholder","Search\u2026",1,"fury-filter-input"],["filter",""],["type","button","mat-icon-button","",1,"fury-column-filter",3,"matMenuTriggerFor"],[1,"checkbox-item","mat-menu-item",3,"click"],[1,"checkbox",3,"ngModel","ngModelChange","click"],["checkbox",""]],template:function(C,F){1&C&&(r.NAR(N),r.j41(0,"div",0),r.DNE(1,h,12,2,"div",1),r.j41(2,"mat-menu",2,3),r.DNE(4,D,4,2,"div",4),r.k0s(),r.SdG(5),r.k0s()),2&C&&(r.R7$(1),r.Y8G("ngIf",!F.hideHeader),r.R7$(3),r.Y8G("ngForOf",F.columns))},dependencies:[v.Sq,v.bT,p.An,R.iY,d.kk,d.Cp,y.So,t.DJ,t.BO,t.sA,t.UI,E.BC,E.vS],styles:[".fury-list-table{display:flex;flex-direction:column}.fury-list-table .fury-list-header{padding-left:24px;padding-right:24px;height:64px;border-top-left-radius:8px;border-top-right-radius:8px}@media screen and (max-width: 599px){.fury-list-table .fury-list-header{height:auto;padding-top:24px;padding-bottom:24px}}.fury-list-table .fury-list-header .fury-list-name{font-size:20px;line-height:32px;font-weight:500;padding-right:24px}@media screen and (max-width: 599px){.fury-list-table .fury-list-header .fury-list-name{border-right:none}}.fury-list-table .fury-list-header .fury-filter-input{font-size:16px;line-height:1.125;border:none;height:32px}.fury-list-table .fury-list-header .fury-filter-input:focus{outline:none}.fury-list-table .fury-list-header .fury-filter-input-icon{width:1.2em;vertical-align:bottom;height:22px;font-size:22px;margin-right:8px}.fury-list-table table{width:100%}.fury-list-table .mat-mdc-header-row .mat-mdc-header-cell .mat-sort-header-button{text-transform:uppercase}.fury-list-table .mat-mdc-cell.image-cell,.fury-list-table .mat-mdc-header-cell.image-cell{flex:0;width:59px}.fury-list-table .mat-mdc-cell.image-cell img,.fury-list-table .mat-mdc-header-cell.image-cell img{border-radius:50%;height:35px;width:35px;margin-right:24px;vertical-align:middle}.fury-list-table .mat-mdc-cell,.fury-list-table .mat-mdc-header-cell{white-space:nowrap;padding-left:12px;padding-right:12px}.fury-list-table .mat-mdc-cell.actions-cell,.fury-list-table .mat-mdc-header-cell.actions-cell{flex:0;width:40px;overflow:visible}.fury-list-table .paginator{display:block}.checkbox-item{padding-right:32px;padding-left:8px}\n"],encapsulation:2})}}return x})()},91398:(T,b,l)=>{l.d(b,{H:()=>v});var r=l(60177),g=l(89417),i=l(12198),m=l(17705);let v=(()=>{class p{static{this.\u0275fac=function(y){return new(y||p)}}static{this.\u0275mod=m.$C({type:p})}static{this.\u0275inj=m.G2t({imports:[r.MD,i.G,g.YN]})}}return p})()},15551:(T,b,l)=>{l.d(b,{M:()=>g});var r=l(17705);let g=(()=>{class i{constructor(){}static{this.\u0275fac=function(p){return new(p||i)}}static{this.\u0275dir=r.FsC({type:i,selectors:[["","furyPageLayoutContent",""],["fury-page-layout-content"]],hostAttrs:[1,"fury-page-layout-content"]})}}return i})()},53007:(T,b,l)=>{l.d(b,{M:()=>g});var r=l(17705);let g=(()=>{class i{constructor(){}static{this.\u0275fac=function(p){return new(p||i)}}static{this.\u0275dir=r.FsC({type:i,selectors:[["","furyPageLayoutHeader",""],["fury-page-layout-header"]],hostAttrs:[1,"fury-page-layout-header"]})}}return i})()},43655:(T,b,l)=>{l.d(b,{T:()=>g});var r=l(17705);let g=(()=>{class i{constructor(){this.mode="simple"}get isCard(){return"card"===this.mode}get isSimple(){return"simple"===this.mode}static{this.\u0275fac=function(p){return new(p||i)}}static{this.\u0275dir=r.FsC({type:i,selectors:[["","furyPageLayout",""],["fury-page-layout"]],hostAttrs:[1,"fury-page-layout"],hostVars:4,hostBindings:function(p,R){2&p&&r.AVh("fury-page-layout-card",R.isCard)("fury-page-layout-simple",R.isSimple)},inputs:{mode:"mode"}})}}return i})()},76337:(T,b,l)=>{l.r(b),l.d(b,{NotaCompraModule:()=>Gt});var r=l(60177),g=l(18498),i=l(89417),m=l(9159),v=l(97586),p=l.n(v),R=l(17206),d=l(34006),y=l(2578),t=l(17705),E=l(97405),f=l(52920),h=l(88834),D=l(86467),N=l(99631);function S(o,c){1&o&&(t.j41(0,"th",18),t.EFF(1," Producto "),t.k0s())}function w(o,c){if(1&o&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.R7$(1),t.SpI(" ",e.nombreProducto," ")}}function x(o,c){1&o&&(t.j41(0,"th",18),t.EFF(1," Cantidad "),t.k0s())}function O(o,c){if(1&o&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.R7$(1),t.SpI(" ",e.cantidad," ")}}function _(o,c){1&o&&(t.j41(0,"th",18),t.EFF(1," Monto "),t.k0s())}function C(o,c){if(1&o&&(t.j41(0,"td",19),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&o){const e=c.$implicit;t.R7$(1),t.SpI(" ",t.bMT(2,1,e.monto)," ")}}function F(o,c){1&o&&t.nrm(0,"tr",20)}function j(o,c){1&o&&t.nrm(0,"tr",21)}let $=(()=>{class o{constructor(e,a,n){this.data=e,this.dialogRef=a,this.apiClient=n,this.detalles=[],this.dataSource=new m.I6([]),this.displayedColumns=["nombreProducto","cantidad","monto"]}ngOnInit(){this.form=new i.J3({id:new i.hs(this.data.id),nombreProveedor:new i.hs(this.data.nombreProveedor),fecha:new i.hs(this.data.fecha),montoTotal:new i.hs(this.data.montoTotal)}),console.log("idNotaCompra",this.data.id),this.apiClient.getRequest("/api/notacompra/get",{id:this.data.id}).subscribe({next:e=>{console.info("NotaCompraCompleto",e),this.dataSource.data=e.detalle},error:e=>{console.error(e)}})}descargarPDF(){this.apiClient.getRequest("/api/notacompra/download-pdf",{id:this.data.id}).subscribe({next:e=>{if(e&&e.pdf){const a=atob(e.pdf),n=new Uint8Array(a.length);for(let u=0;u<a.length;u++)n[u]=a.charCodeAt(u);const s=new Blob([n],{type:"application/pdf"});(0,y.saveAs)(s,`nota_compra_${this.data.id}.pdf`)}else console.error("Error: el PDF no contiene datos."),alert("No se pudo generar el PDF. Int\xe9ntalo de nuevo m\xe1s tarde.")},error:e=>{console.error("Error al descargar el PDF",e),alert("Ocurri\xf3 un error al intentar descargar el PDF.")}})}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.Vh),t.rXU(d.CP),t.rXU(E.f))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["fury-nota-compra-detalles"]],decls:39,vars:4,consts:[["mat-dialog-title",""],[3,"formGroup"],["fxLayout","column wrap"],["fxFlex",""],["matInput","","formControlName","id","readonly",""],["matInput","","formControlName","nombreProveedor","readonly",""],["matInput","","formControlName","fecha","readonly",""],["matInput","","formControlName","montoTotal","readonly",""],[2,"text-align","right","margin-top","15px"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8",2,"width","100%","margin-top","20px",3,"dataSource"],["matColumnDef","nombreProducto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","cantidad"],["matColumnDef","monto"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(a,n){1&a&&(t.j41(0,"div",0),t.EFF(1," Informacion Completa de la Nota de Compra "),t.k0s(),t.j41(2,"form",1)(3,"mat-dialog-content")(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t.EFF(7,"id"),t.k0s(),t.nrm(8,"input",4),t.k0s(),t.j41(9,"mat-form-field",3)(10,"mat-label"),t.EFF(11,"nombre del Proveedor"),t.k0s(),t.nrm(12,"input",5),t.k0s(),t.j41(13,"mat-form-field",3)(14,"mat-label"),t.EFF(15,"fecha"),t.k0s(),t.nrm(16,"input",6),t.k0s(),t.j41(17,"mat-form-field",3)(18,"mat-label"),t.EFF(19,"montoTotal"),t.k0s(),t.nrm(20,"input",7),t.k0s()(),t.j41(21,"div",8)(22,"button",9),t.bIt("click",function(){return n.closeDialog()}),t.EFF(23,"Cerrar"),t.k0s()(),t.j41(24,"div",8)(25,"button",9),t.bIt("click",function(){return n.descargarPDF()}),t.EFF(26,"Descargar"),t.k0s()(),t.j41(27,"table",10),t.qex(28,11),t.DNE(29,S,2,0,"th",12),t.DNE(30,w,2,1,"td",13),t.bVm(),t.qex(31,14),t.DNE(32,x,2,0,"th",12),t.DNE(33,O,2,1,"td",13),t.bVm(),t.qex(34,15),t.DNE(35,_,2,0,"th",12),t.DNE(36,C,3,3,"td",13),t.bVm(),t.DNE(37,F,1,0,"tr",16),t.DNE(38,j,1,0,"tr",17),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("formGroup",n.form),t.R7$(25),t.Y8G("dataSource",n.dataSource),t.R7$(10),t.Y8G("matHeaderRowDef",n.displayedColumns),t.R7$(1),t.Y8G("matRowDefColumns",n.displayedColumns))},dependencies:[f.DJ,f.UI,h.$z,d.BI,d.Yi,D.rl,D.nJ,N.fg,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,i.qT,i.me,i.BC,i.cb,i.j4,i.JD,r.oe]})}}return o})();var I=l(86600),A=l(82798),M=l(25084),L=l(82765);function H(o,c){1&o&&(t.j41(0,"mat-error"),t.EFF(1,"Fecha de inicio inv\xe1lida"),t.k0s())}function K(o,c){1&o&&(t.j41(0,"mat-error"),t.EFF(1,"Fecha de fin inv\xe1lida"),t.k0s())}function W(o,c){1&o&&(t.j41(0,"mat-error"),t.EFF(1," El monto debe ser mayor o igual a 0. "),t.k0s())}function Z(o,c){1&o&&(t.j41(0,"mat-error"),t.EFF(1," El monto debe ser mayor o igual a 0. "),t.k0s())}function Q(o,c){if(1&o&&(t.j41(0,"mat-option",19),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.Y8G("value",e.nombre),t.R7$(1),t.SpI(" ",e.nombre," ")}}function q(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",20)(1,"mat-checkbox",21),t.bIt("ngModelChange",function(n){const u=t.eBV(e).$implicit;return t.Njj(u.selected=n)}),t.EFF(2),t.k0s()()}if(2&o){const e=c.$implicit;t.Y8G("hidden",!e.visible||"actions"===e.property),t.R7$(1),t.Y8G("ngModel",e.selected),t.R7$(1),t.SpI(" ",e.name," ")}}let tt=(()=>{class o{constructor(e,a){this.dialogRef=e,this.data=a,this.columns=a.columns,this.proveedoresList=a.proveedoresList,this.form=new i.gE({from:new i.MJ(p()().subtract(10,"days").toDate()),to:new i.MJ(p()().toDate()),montoMayor:new i.MJ(null,[i.k0.min(0),i.k0.pattern(/^\d+(\.\d{1,2})?$/)]),montoMenor:new i.MJ(null,[i.k0.min(0),i.k0.pattern(/^\d+(\.\d{1,2})?$/)]),nombreProveedor:new i.MJ(null)})}ngOnInit(){}formatDecimals(e){const a=this.form.get(e);null!=a?.value&&""!==a.value&&a.setValue(parseFloat(a.value).toFixed(2))}generateReport(){const e=this.columns.filter(s=>s.selected).map(({name:s,property:u})=>({name:s,property:u}));if(0===e.length)return void alert("Debe seleccionar al menos una cabecera para el reporte.");const n={filtros:{inicio:this.form.value.from?(0,r.Yq)(this.form.value.from,"dd/MM/yyyy","en"):null,fin:this.form.value.to?(0,r.Yq)(this.form.value.to,"dd/MM/yyyy","en"):null,montoMayor:this.form.value.montoMayor,montoMenor:this.form.value.montoMenor,nombreProveedor:this.form.value.nombreProveedor},headers:e,tipoReporte:"Compras"};this.dialogRef.close(n)}closeDialog(){this.dialogRef.close(null)}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(d.CP),t.rXU(d.Vh))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["fury-crear-reporte-compra"]],decls:41,vars:9,consts:[["mat-dialog-title",""],["fxLayout","row wrap","fxLayoutGap","16px","fxLayoutAlign","start start",3,"formGroup"],["fxFlex","100","fxFlex.xs","100"],[3,"rangePicker"],["matStartDate","","formControlName","from","placeholder","Inicio"],["matEndDate","","formControlName","to","placeholder","Fin"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["fxFlex","50","fxFlex.xs","100"],["matInput","","type","number","formControlName","montoMayor","placeholder","Ingrese monto mayor","min","0","step","1",3,"input","blur"],["matInput","","type","number","formControlName","montoMenor","placeholder","Ingrese monto menor","min","0","step","1",3,"input","blur"],["formControlName","nombreProveedor"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayoutGap","16px","fxLayoutAlign","start start",1,"checkbox-container"],["fxFlex","25%",3,"hidden",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","mat-dialog-close",""],[3,"value"],["fxFlex","25%",3,"hidden"],[3,"ngModel","ngModelChange"]],template:function(a,n){if(1&a&&(t.j41(0,"h2",0),t.EFF(1,"Generar Reporte"),t.k0s(),t.j41(2,"mat-dialog-content")(3,"h3"),t.EFF(4,"Filtros del Reporte"),t.k0s(),t.j41(5,"div",1)(6,"mat-form-field",2)(7,"mat-label"),t.EFF(8,"Rango de fecha"),t.k0s(),t.j41(9,"mat-date-range-input",3),t.nrm(10,"input",4)(11,"input",5),t.k0s(),t.nrm(12,"mat-datepicker-toggle",6)(13,"mat-date-range-picker",null,7),t.DNE(15,H,2,0,"mat-error",8),t.DNE(16,K,2,0,"mat-error",8),t.k0s(),t.j41(17,"mat-form-field",9)(18,"mat-label"),t.EFF(19,"Monto Mayor"),t.k0s(),t.j41(20,"input",10),t.bIt("input",function(){return n.formatDecimals("montoMayor")})("blur",function(){return n.formatDecimals("montoMayor")}),t.k0s(),t.DNE(21,W,2,0,"mat-error",8),t.k0s(),t.j41(22,"mat-form-field",9)(23,"mat-label"),t.EFF(24,"Monto Menor"),t.k0s(),t.j41(25,"input",11),t.bIt("input",function(){return n.formatDecimals("montoMenor")})("blur",function(){return n.formatDecimals("montoMenor")}),t.k0s(),t.DNE(26,Z,2,0,"mat-error",8),t.k0s(),t.j41(27,"mat-form-field",2)(28,"mat-label"),t.EFF(29,"Proveedor"),t.k0s(),t.j41(30,"mat-select",12),t.DNE(31,Q,2,2,"mat-option",13),t.k0s()()(),t.j41(32,"h3"),t.EFF(33,"Cabeceras del Reporte"),t.k0s(),t.j41(34,"div",14),t.DNE(35,q,3,3,"div",15),t.k0s()(),t.j41(36,"mat-dialog-actions",16)(37,"button",17),t.bIt("click",function(){return n.generateReport()}),t.EFF(38,"Generar"),t.k0s(),t.j41(39,"button",18),t.EFF(40,"Cancelar"),t.k0s()()),2&a){const s=t.sdS(14);t.R7$(5),t.Y8G("formGroup",n.form),t.R7$(4),t.Y8G("rangePicker",s),t.R7$(3),t.Y8G("for",s),t.R7$(3),t.Y8G("ngIf",n.form.controls.from.hasError("matStartDateInvalid")),t.R7$(1),t.Y8G("ngIf",n.form.controls.to.hasError("matEndDateInvalid")),t.R7$(5),t.Y8G("ngIf",n.form.controls.montoMayor.hasError("min")),t.R7$(5),t.Y8G("ngIf",n.form.controls.montoMenor.hasError("min")),t.R7$(5),t.Y8G("ngForOf",n.proveedoresList),t.R7$(4),t.Y8G("ngForOf",n.columns)}},dependencies:[r.Sq,r.bT,f.DJ,f.BO,f.sA,f.UI,h.$z,d.tx,d.BI,d.Yi,d.E7,D.rl,D.nJ,D.TL,D.yw,N.fg,i.me,i.Q0,i.BC,i.cb,i.VZ,i.j4,i.JD,I.wT,A.VO,M.bU,M.el,M.xR,M.IG,M.SG,i.vS,L.So]})}}return o})();var V=l(74061),U=l(75063),Y=l(99213),P=l(59115),B=l(96695),G=l(2042),z=l(43655),J=l(53007),X=l(15551);function et(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.generarReporte())}),t.EFF(1," Generar Reporte "),t.k0s()}}function ot(o,c){1&o&&(t.j41(0,"th",18)(1,"mat-checkbox",19),t.bIt("click",function(a){return a.stopPropagation()}),t.k0s()())}function rt(o,c){1&o&&(t.j41(0,"td",20)(1,"mat-checkbox",19),t.bIt("click",function(a){return a.stopPropagation()}),t.k0s()())}function at(o,c){if(1&o&&(t.j41(0,"th",25),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",e.name,"")}}function nt(o,c){if(1&o&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&o){const e=c.$implicit,a=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",e[a.property]," ")}}function it(o,c){if(1&o&&(t.qex(0,22),t.DNE(1,at,2,1,"th",23),t.DNE(2,nt,2,1,"td",24),t.bVm()),2&o){const e=t.XpG().$implicit;t.Y8G("matColumnDef",e.property)}}function lt(o,c){if(1&o&&(t.qex(0),t.DNE(1,it,3,1,"ng-container",21),t.bVm()),2&o){const e=c.$implicit;t.R7$(1),t.Y8G("ngIf",e.isModelProperty)}}function st(o,c){1&o&&t.nrm(0,"th",27)}function ct(o,c){if(1&o){const e=t.RV6();t.j41(0,"td",20)(1,"button",28),t.bIt("click",function(n){return n.stopPropagation()}),t.j41(2,"mat-icon"),t.EFF(3,"more_horiz"),t.k0s()(),t.j41(4,"mat-menu",29,30)(6,"button",31),t.bIt("click",function(){const s=t.eBV(e).$implicit,u=t.XpG();return t.Njj(u.verDeatlles(s))}),t.j41(7,"span"),t.EFF(8,"ver detalles"),t.k0s()(),t.j41(9,"button",31),t.bIt("click",function(){const s=t.eBV(e).$implicit,u=t.XpG();return t.Njj(u.anularNotaDeCompra(s))}),t.j41(10,"span"),t.EFF(11,"Delete"),t.k0s()()()()}if(2&o){const e=t.sdS(5);t.R7$(1),t.Y8G("matMenuTriggerFor",e)}}function mt(o,c){1&o&&t.nrm(0,"tr",32)}function ut(o,c){if(1&o){const e=t.RV6();t.j41(0,"tr",33),t.bIt("click",function(){const s=t.eBV(e).$implicit,u=t.XpG();return t.Njj(u.verDeatlles(s))}),t.k0s()}}const pt=function(){return["Nota de Compra"]},dt=function(){return[]};function ht(o,c){if(1&o&&(t.j41(0,"mat-option",25),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.Y8G("value",e.nombre),t.R7$(1),t.SpI(" ",e.nombre," ")}}function _t(o,c){if(1&o&&(t.j41(0,"mat-option",25),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.Y8G("value",e.id),t.R7$(1),t.SpI(" ",e.nombre," ")}}function Ct(o,c){1&o&&(t.j41(0,"th",26)(1,"mat-checkbox",27),t.bIt("click",function(a){return a.stopPropagation()}),t.k0s()())}function gt(o,c){1&o&&(t.j41(0,"td",28)(1,"mat-checkbox",27),t.bIt("click",function(a){return a.stopPropagation()}),t.k0s()())}function bt(o,c){if(1&o&&(t.j41(0,"th",33),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",e.name,"")}}function yt(o,c){if(1&o&&(t.j41(0,"td",34),t.EFF(1),t.k0s()),2&o){const e=c.$implicit,a=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",e[a.property]," ")}}function Dt(o,c){if(1&o&&(t.qex(0,30),t.DNE(1,bt,2,1,"th",31),t.DNE(2,yt,2,1,"td",32),t.bVm()),2&o){const e=t.XpG().$implicit;t.Y8G("matColumnDef",e.property)}}function vt(o,c){if(1&o&&(t.qex(0),t.DNE(1,Dt,3,1,"ng-container",29),t.bVm()),2&o){const e=c.$implicit;t.R7$(1),t.Y8G("ngIf",e.isModelProperty)}}function xt(o,c){1&o&&t.nrm(0,"th",35)}function Ft(o,c){if(1&o){const e=t.RV6();t.j41(0,"td",28)(1,"button",36),t.bIt("click",function(n){return n.stopPropagation()}),t.j41(2,"mat-icon"),t.EFF(3,"more_horiz"),t.k0s()(),t.j41(4,"mat-menu",37,38)(6,"button",39),t.bIt("click",function(){const s=t.eBV(e).$implicit,u=t.XpG();return t.Njj(u.deleteDetalle(s))}),t.j41(7,"span"),t.EFF(8,"Delete"),t.k0s()()()()}if(2&o){const e=t.sdS(5);t.R7$(1),t.Y8G("matMenuTriggerFor",e)}}function Et(o,c){1&o&&t.nrm(0,"tr",40)}function kt(o,c){if(1&o){const e=t.RV6();t.j41(0,"tr",41),t.bIt("click",function(){const s=t.eBV(e).$implicit,u=t.XpG();return t.Njj(u.updateDetalle(s))}),t.k0s()}}const Rt=function(){return["Detalles-Compra"]},Nt=function(){return[]},Mt=[{path:"",component:(()=>{class o{constructor(e,a,n){this.apiClient=e,this.dialog=a,this.router=n,this.proveedoresList=[],this.dataSource=new m.I6([]),this.columns=[{name:"ID",property:"id",visible:!0,isModelProperty:!0,selected:!0},{name:"Fecha",property:"fecha",visible:!0,isModelProperty:!0,selected:!0},{name:"Monto Total",property:"montoTotal",visible:!0,isModelProperty:!0,selected:!0},{name:"Proveedor",property:"nombreProveedor",visible:!0,isModelProperty:!0,selected:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10,this.userActions={},this.successActionList=s=>{this.userActions=s},this.form=new i.gE({from:new i.MJ(p()().subtract(10,"days").toDate()),to:new i.MJ(p()().toDate()),montoMayor:new i.MJ(null,[i.k0.min(0),i.k0.pattern(/^\d+(\.\d{1,2})?$/)]),montoMenor:new i.MJ(null,[i.k0.min(0),i.k0.pattern(/^\d+(\.\d{1,2})?$/)]),nombreProveedor:new i.MJ(null)})}get visibleColumns(){return this.columns.filter(e=>e.visible).map(e=>e.property)}ngOnInit(){this.apiClient.getRequest("/api/proveedor").subscribe({next:e=>{this.proveedoresList=[{id:null,nombre:"todos"},...e],console.info("proveedoresList",e)},error:e=>{console.error(e)}}),this.getNotasDeCompra(),this.apiClient.getRequest("/api/v1/resource/actions-by-user?frontendCode=PAGE_NOTACOMPRA").subscribe({next:this.successActionList})}formatDecimals(e){const a=this.form.get(e);null!=a?.value&&""!==a.value&&a.setValue(parseFloat(a.value).toFixed(2))}onFilterChange(e){console.info(event),this.dataSource&&(e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e)}getNotasDeCompra(){this.apiClient.getRequest("/api/notacompra").subscribe({next:e=>{this.dataSource.data=e,console.log(e)},error:e=>{console.error(e)}})}createNotaDeCompra(){this.router.navigate(["compras/nota-Compra/detalles-compra"]).then(()=>{this.getNotasDeCompra()})}generarReporte(){this.dialog.open(tt,{width:"600px",data:{columns:this.columns,proveedoresList:this.proveedoresList}}).afterClosed().subscribe(e=>{e&&(console.log("Datos para el reporte:",e),this.apiClient.postRequest("/api/reporte/generar-excel",e).subscribe({next:a=>{console.log(a),R.R.downloadFromBase64(a.base64Archivo,"excel.xlsx",a.tipoRespaldo)}}))})}anularNotaDeCompra(e){this.apiClient.deleteRequest(e.id,"/api/notacompra").subscribe({next:a=>{this.getNotasDeCompra()},error:a=>{}})}verDeatlles(e){console.info("Nota de compra",e),this.dialog.open($,{data:e,width:"400px"})}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(E.f),t.rXU(d.bZ),t.rXU(g.Ix))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["fury-nota-compra"]],decls:22,vars:10,consts:[["mode","card"],["current","Nota de Compra",3,"crumbs"],["name","Notas de Compra",3,"columns","filterChange"],[1,"actions"],["fxLayout","row","fxLayoutGap","16px"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["class","generarReporte","type","button","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","checkbox"],["class","actions-cell","mat-header-cell","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],["type","button","mat-raised-button","","color","primary",1,"generarReporte",3,"click"],["mat-header-cell","",1,"actions-cell"],["color","primary",3,"click"],["mat-cell","",1,"actions-cell"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"fury-page-layout",0)(1,"fury-page-layout-header"),t.nrm(2,"fury-breadcrumbs",1),t.k0s(),t.j41(3,"fury-page-layout-content")(4,"fury-list",2),t.bIt("filterChange",function(u){return n.onFilterChange(u)}),t.j41(5,"div",3)(6,"div",4)(7,"button",5),t.bIt("click",function(){return n.createNotaDeCompra()}),t.j41(8,"mat-icon"),t.EFF(9,"add"),t.k0s()(),t.DNE(10,et,2,0,"button",6),t.k0s()(),t.j41(11,"table",7),t.qex(12,8),t.DNE(13,ot,2,0,"th",9),t.DNE(14,rt,2,0,"td",10),t.bVm(),t.DNE(15,lt,2,1,"ng-container",11),t.qex(16,12),t.DNE(17,st,1,0,"th",13),t.DNE(18,ct,12,1,"td",10),t.bVm(),t.DNE(19,mt,1,0,"tr",14),t.DNE(20,ut,1,0,"tr",15),t.k0s(),t.nrm(21,"mat-paginator",16),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("crumbs",t.lJ4(8,pt)),t.R7$(2),t.Y8G("columns",t.lJ4(9,dt)),t.R7$(6),t.Y8G("ngIf",n.userActions.toExcelAction),t.R7$(1),t.Y8G("dataSource",n.dataSource),t.R7$(4),t.Y8G("ngForOf",n.columns),t.R7$(4),t.Y8G("matHeaderRowDef",n.visibleColumns),t.R7$(1),t.Y8G("matRowDefColumns",n.visibleColumns),t.R7$(1),t.Y8G("pageSize",n.pageSize))},dependencies:[r.Sq,r.bT,V.m,f.DJ,f.BO,U.s,h.$z,h.iY,h.$0,L.So,Y.An,P.kk,P.fb,P.Cp,B.iy,G.B4,G.aE,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,z.T,J.M,X.M],styles:['@charset "UTF-8";.checkbox-container[_ngcontent-%COMP%]{margin-top:16px}mat-form-field[_ngcontent-%COMP%]{margin-bottom:16px}@media (max-width: 600px){[fxFlex="33%"][_ngcontent-%COMP%]{flex:0 0 100%}[fxFlex="25%"][_ngcontent-%COMP%]{flex:0 0 50%}}']})}}return o})()},{path:"detalles-compra",component:(()=>{class o{constructor(e,a){this.apiClient=e,this.router=a,this.productosList=[],this.proveedoresList=[],this.detalles=[],this.dataSource=new m.I6([]),this.columns=[{name:"ID Producto",property:"idProducto",visible:!0,isModelProperty:!0},{name:"Cantidad",property:"cantidad",visible:!0,isModelProperty:!0},{name:"Monto",property:"monto",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0}],this.pageSize=10,this.form=new i.J3({idProducto:new i.hs(""),nombreProveedor:new i.hs(""),cant:new i.hs(""),stock:new i.hs({value:0,disabled:!0}),precioUnitario:new i.hs({value:0,disabled:!0}),monto:new i.hs("")})}get visibleColumns(){return this.columns.filter(e=>e.visible).map(e=>e.property)}ngOnInit(){this.apiClient.getRequest("/api/producto").subscribe({next:e=>{this.productosList=e,console.info(e)},error:e=>{console.error(e)}}),this.apiClient.getRequest("/api/proveedor").subscribe({next:e=>{this.proveedoresList=e,console.info(e)},error:e=>{console.error(e)}}),this.form.get("idProducto")?.valueChanges.subscribe(e=>{this.actualizarCamposProducto(e)})}agregarDetalle(){const{idProducto:e,cant:a,monto:n}=this.form.getRawValue(),s=this.productosList.find(k=>k.id===e);if(console.log("pro",s),!s)return void console.error("Producto no encontrado o no seleccionado");s.stock=s.stock+Number(a),console.log("proSelec",s),this.apiClient.putRequest("/api/producto",s.id,s).subscribe({next:k=>{console.log(k)},error:k=>{console.error("Error al actualizar  producto:",k)}});const u=this.detalles.find(k=>k.idProducto===e);if(console.log("detalleExistente",u),u)u.cantidad=Number(u.cantidad)+Number(a),u.monto=n;else{const k={idProducto:e,cantidad:a,monto:n};console.log("nuevo Detalle",k),this.detalles.push(k)}console.log("listDetalles",this.detalles),this.dataSource.data=[...this.detalles],this.form.patchValue({idProducto:null,cant:0,precioUnitario:0,stock:0})}guardarDetalles(){const a={nombreProveedor:this.form.get("nombreProveedor")?.value,detalles:this.detalles,montoTotal:0};console.log("DetallesCompra",a),this.apiClient.postRequest("/api/notacompra",a).subscribe({next:n=>{console.info("Detalles guardados correctamente:",n),this.router.navigate(["compras/nota-Compra"])},error:n=>{console.error("Error al guardar los detalles:",n)}})}actualizarCamposProducto(e){const a=this.productosList.find(n=>n.id===e);console.log(a),this.form.patchValue(a?{precioUnitario:a.precioUnitario,stock:a.stock}:{precioUnitario:0,stock:0})}actualizarMonto(){this.form.get("cant"),this.form.get("precioUnitario");this.form.patchValue({monto:this.form.value})}updateDetalle(e){}deleteDetalle(e){console.log("row",e),console.log("ListPro",this.productosList);const a=this.productosList.find(n=>n.id===e.idProducto);this.detalles=this.detalles.filter(n=>n.idProducto!==e.idProducto),console.log("producto",a),console.log("detallesList",this.detalles),a.stock=Number(a.stock)-Number(e.cantidad),this.apiClient.putRequest("/api/producto",a.id,a).subscribe({next:n=>{console.log(n),this.apiClient.getRequest("/api/producto").subscribe({next:s=>{this.productosList=s,console.info(s)},error:s=>{console.error(s)}}),this.dataSource.data=this.dataSource.data.filter(s=>s.idProducto!==e.idProducto)},error:n=>{console.error("Error al actualizar  producto:",n)}})}onFilterChange(e){console.info(event),this.dataSource&&(e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e)}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(E.f),t.rXU(g.Ix))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["fury-crear-actualizar-nota-compra"]],inputs:{columns:"columns"},decls:46,vars:12,consts:[["mode","card"],["current","Detalles",3,"crumbs"],["name","Detalle de Compra",3,"columns","filterChange"],["fxLayout","row wrap",3,"formGroup"],["formControlName","nombreProveedor"],[3,"value",4,"ngFor","ngForOf"],["formControlName","idProducto"],["fxFlex",""],["type","text","matInput","","formControlName","stock","readonly",""],["type","text","formControlName","cant","matInput",""],["type","text","formControlName","monto","matInput",""],[1,"actions"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","checkbox"],["class","actions-cell","mat-header-cell","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[2,"margin-top","20px","text-align","right"],["mat-raised-button","","color","primary",3,"click"],[3,"value"],["mat-header-cell","",1,"actions-cell"],["color","primary",3,"click"],["mat-cell","",1,"actions-cell"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(a,n){1&a&&(t.j41(0,"fury-page-layout",0)(1,"fury-page-layout-header"),t.nrm(2,"fury-breadcrumbs",1),t.k0s(),t.j41(3,"fury-page-layout-content")(4,"fury-list",2),t.bIt("filterChange",function(u){return n.onFilterChange(u)}),t.j41(5,"div",3)(6,"mat-form-field")(7,"mat-label"),t.EFF(8,"Proveedor"),t.k0s(),t.j41(9,"mat-select",4),t.DNE(10,ht,2,2,"mat-option",5),t.k0s()(),t.j41(11,"mat-form-field")(12,"mat-label"),t.EFF(13,"Productos"),t.k0s(),t.j41(14,"mat-select",6),t.DNE(15,_t,2,2,"mat-option",5),t.k0s()(),t.j41(16,"mat-form-field",7)(17,"mat-label"),t.EFF(18,"Stock"),t.k0s(),t.nrm(19,"input",8),t.k0s(),t.j41(20,"mat-form-field",7)(21,"mat-label"),t.EFF(22,"Cantidad"),t.k0s(),t.nrm(23,"input",9),t.k0s(),t.j41(24,"mat-form-field",7)(25,"mat-label"),t.EFF(26,"Monto"),t.k0s(),t.nrm(27,"input",10),t.k0s(),t.j41(28,"div",11)(29,"button",12),t.bIt("click",function(){return n.agregarDetalle()}),t.j41(30,"mat-icon"),t.EFF(31,"add"),t.k0s()()()(),t.j41(32,"table",13),t.qex(33,14),t.DNE(34,Ct,2,0,"th",15),t.DNE(35,gt,2,0,"td",16),t.bVm(),t.DNE(36,vt,2,1,"ng-container",17),t.qex(37,18),t.DNE(38,xt,1,0,"th",19),t.DNE(39,Ft,9,1,"td",16),t.bVm(),t.DNE(40,Et,1,0,"tr",20),t.DNE(41,kt,1,0,"tr",21),t.k0s(),t.nrm(42,"mat-paginator",22),t.k0s(),t.j41(43,"div",23)(44,"button",24),t.bIt("click",function(){return n.guardarDetalles()}),t.EFF(45," Guardar y Volver a Recibos "),t.k0s()()()()),2&a&&(t.R7$(2),t.Y8G("crumbs",t.lJ4(10,Rt)),t.R7$(2),t.Y8G("columns",t.lJ4(11,Nt)),t.R7$(1),t.Y8G("formGroup",n.form),t.R7$(5),t.Y8G("ngForOf",n.proveedoresList),t.R7$(5),t.Y8G("ngForOf",n.productosList),t.R7$(17),t.Y8G("dataSource",n.dataSource),t.R7$(4),t.Y8G("ngForOf",n.columns),t.R7$(4),t.Y8G("matHeaderRowDef",n.visibleColumns),t.R7$(1),t.Y8G("matRowDefColumns",n.visibleColumns),t.R7$(1),t.Y8G("pageSize",n.pageSize))},dependencies:[r.Sq,r.bT,V.m,f.DJ,f.UI,U.s,h.$z,h.iY,h.$0,L.So,D.rl,D.nJ,Y.An,P.kk,P.fb,P.Cp,B.iy,G.B4,G.aE,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,z.T,J.M,X.M,i.me,i.BC,i.cb,i.j4,i.JD,N.fg,I.wT,A.VO]})}}return o})()}];let Pt=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[g.iI.forChild(Mt),g.iI]})}}return o})();var Tt=l(3632),jt=l(91398),It=l(49320);let $t=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[r.MD,f.w2,h.Hl,d.hM,D.RG,N.fS,m.tP,i.X1]})}}return o})(),Lt=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[r.MD,f.w2,h.Hl,d.hM,D.RG,N.fS,i.X1,I.Sy,A.Ve,M.X6,i.YN,L.g7]})}}return o})(),Gt=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[r.MD,Pt,Tt.V,f.w2,jt.H,h.Hl,L.g7,M.X6,D.RG,Y.m_,P.Cn,B.Ou,G.NQ,m.tP,It.S,i.X1,N.fS,I.Sy,A.Ve,$t,i.YN,Lt,d.hM]})}}return o})()}}]);